<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Business Owner Sign Up - Black Service Spot</title>
<meta name="description" content="Register your business on Black Service Spot. Choose a plan, add your details, and get discovered by customers in your area."/>
<style>
  :root{
    --g1:#2ecc71; --g2:#1abc9c; --g3:#16a085;
    --bg:#f6f7fb; --text:#102a43; --muted:#6b7280; --card:#ffffff; --ring:#2ecc71; --border:#e6e9ef;
    --btn:#1db954; --btn-hover:#18a94b; --btn-outline:#1db954;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text)}
  header{background:#fff;border-bottom:1px solid #eef2f7}
  .nav{max-width:1100px;margin:0 auto;padding:.75rem 1rem;display:flex;align-items:center;justify-content:space-between}
  .brand{display:flex;align-items:center;gap:.5rem;color:#0f9d58;font-weight:800}
  .brand svg{color:#0f9d58}
  .main{min-height:100vh;background:linear-gradient(180deg, #eafaf1 0%, #eafaf1 140px, transparent 140px);padding:2rem 1rem 3rem;display:flex;justify-content:center}
  .card{width:100%;max-width:1000px;background:var(--card);border-radius:16px;box-shadow:0 10px 24px rgba(0,0,0,.08),0 2px 6px rgba(0,0,0,.04);overflow:hidden;border:1px solid #e7f5ee}
  .card-header{background:linear-gradient(180deg,#31d07e,#1db954);color:#053d2f;padding:16px 18px}
  .card-header h1{margin:0;font-size:22px}
  .section{padding:18px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .section h2{font-size:16px;margin:0 0 10px 0;color:#184b3a}
  label{font-weight:700;display:block;margin:8px 0 6px;color:#2c3e50;font-size:14px}
  input[type="text"],input[type="email"],input[type="file"],select,textarea{
    width:100%;padding:12px 14px;border:1px solid #cfe8db;background:#fff;border-radius:10px;outline:none;font-size:14px;
    box-shadow:0 1px 0 rgba(0,0,0,.02) inset;transition:border-color .15s, box-shadow .15s;
  }
  input::placeholder,textarea::placeholder{color:#9aa7b2}
  textarea{min-height:100px;resize:vertical}
  input:focus,select:focus,textarea:focus{border-color:#78d9ae;box-shadow:0 0 0 3px rgba(29,185,84,.15)}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
  .actions{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  .btn{border:none;padding:12px 16px;border-radius:10px;font-weight:800;cursor:pointer;font-size:14px}
  .btn-primary{background:var(--btn);color:#fff;box-shadow:0 6px 14px rgba(29,185,84,.25)}
  .btn-primary:hover{background:var(--btn-hover)}
  .btn-secondary{background:transparent;color:var(--btn-outline);border:2px solid var(--btn-outline);}
  .muted{color:#64748b;font-size:13px}
  .disclaimer{background:#e7f7ed;border:1px solid #bfead1;color:#0f5132;padding:10px 14px;border-radius:10px;font-size:14px}
  footer{max-width:1000px;margin:8px auto 0;padding:0 1rem;color:#0f5132}
  .small{font-size:13px}
  @media (max-width:840px){.grid{grid-template-columns:1fr}.row{grid-template-columns:1fr}}
</style>
</head>
<body>
<header>
  <div class="nav">
    <div class="brand">
      <svg width="28" height="28" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2 13.09 8.26 22 9l-8.91.74L12 16 10.91 9.74 2 9l8.91-.74L12 2z"/></svg>
      Black Service Spot — Business Registration
    </div>
    <div><a href="index.html" class="small" style="text-decoration:none;color:#0f9d58">← Back to Home</a></div>
  </div>
</header>

<main class="main">
  <div class="card">
    <div class="card-header"><h1>Register Your Business</h1></div>

    <form id="signupForm" class="section" autocomplete="on">
      <div class="disclaimer" style="margin-bottom:12px;">
        <strong>Important:</strong> Complete the form below. Your data is saved to our secure database, then you’ll be taken to PayPal to start your subscription.
      </div>

      <div class="grid">
        <section>
          <h2>Business Owner Information</h2>

          <label for="ownerName">Your Name</label>
          <input id="ownerName" name="ownerName" type="text" placeholder="First Last" required />

          <label for="businessName">Business Name</label>
          <input id="businessName" name="businessName" type="text" placeholder="Your LLC or DBA" required />

          <label for="email">Email Address</label>
          <input id="email" name="email" type="email" placeholder="you@business.com" required />

          <label for="phone">Phone Number</label>
          <input id="phone" name="phone" type="text" placeholder="(555) 555-5555" />

          <div class="row">
            <div>
              <label for="stateSelect">State</label>
              <select id="stateSelect" name="state" required>
                <option value="" disabled selected>Select State</option>
              </select>
            </div>
            <div>
              <label for="citySelect">City</label>
              <select id="citySelect" name="city" required disabled>
                <option value="" disabled selected>Select City</option>
              </select>
            </div>
          </div>

          <label for="address">Business Address <span class="muted">(optional)</span></label>
          <input id="address" name="address" type="text" placeholder="123 Main St, Suite 100" />

          <div class="row">
            <div>
              <label for="hours">Hours of Operation <span class="muted">(optional)</span></label>
              <input id="hours" name="hours" type="text" placeholder="Mon–Fri 9am–5pm" />
            </div>
            <div>
              <label for="logo">Business Logo</label>
              <input id="logo" name="logo" type="file" accept="image/*" />
            </div>
          </div>
        </section>

        <section>
          <h2>Services & Notes</h2>

          <label for="businessType">Business Type</label>
          <input id="businessType" name="businessType" type="text" placeholder="Barber, Caterer, Consultant..." required />

          <label for="services">List of Services</label>
          <textarea id="services" name="services" placeholder="e.g., Braids, Locs, Silk Press (comma-separated)"></textarea>

          <label for="specialInstructions">Private Notes <span class="muted">(visible to you only)</span></label>
          <textarea id="specialInstructions" name="specialInstructions" placeholder="Any special internal notes..."></textarea>

          <h2 style="margin-top:.5rem;">Choose a Plan</h2>
          <div class="row">
            <div>
              <label for="planSelect">Subscription</label>
              <select id="planSelect" name="plan" required>
                <option value="monthly">Monthly — $29.95 + $4.95</option>
                <option value="annual">Annual — $287.52 + $4.95</option>
              </select>
            </div>
            <div>
              <label>&nbsp;</label>
              <div class="actions">
                <button type="submit" class="btn btn-primary" id="submitBtn">Continue to Payment</button>
                <button type="button" class="btn btn-secondary" onclick="window.location.href='index.html'">Cancel</button>
              </div>
            </div>
          </div>
          <p class="muted" style="margin-top:4px;">By continuing, you agree to our Terms of Service and Privacy Policy.</p>
        </section>
      </div>

      <input type="hidden" id="stateHidden" name="stateHidden" />
      <input type="hidden" id="cityHidden"  name="cityHidden" />
    </form>
  </div>
</main>

<footer><p class="small">© 2025 Black Service Spot</p></footer>

<!-- Firebase (module) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
  const firebaseConfig = {
    apiKey: "AIzaSyDHROoVHEPvBSo7ZXGZB2xf7Wnb_U9SErs",
    authDomain: "black-service-spot.firebaseapp.com",
    projectId: "black-service-spot",
    storageBucket: "black-service-spot.firebasestorage.app",
    messagingSenderId: "707361777966",
    appId: "1:707361777966:web:f41f3276b26d5dca50b2bf",
    measurementId: "G-HDD97PF8K7"
  };
  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  window.BSS = window.BSS || {};
  window.BSS.save = async function(){
    const $ = id => document.getElementById(id);
    const ownerName  = $("ownerName").value.trim();
    const business   = $("businessName").value.trim();
    const email      = $("email").value.trim();
    const phone      = $("phone").value.trim();
    const state      = $("stateHidden").value || $("stateSelect").value;
    const city       = $("cityHidden").value  || $("citySelect").value;
    const address    = $("address").value.trim();
    const hours      = $("hours").value.trim();
    const businessType = $("businessType").value.trim();
    const services   = ($("services").value || "").split(",").map(s=>s.trim()).filter(Boolean);
    const notes      = $("specialInstructions").value.trim();
    const plan       = $("planSelect").value;

    if(!ownerName || !business || !email || !state || !city || !businessType){
      throw new Error("Please complete all required fields.");
    }

    const docId = business.replace(/[^\w\- ]+/g,"").trim().replace(/\s+/g,"-").toLowerCase();
    await setDoc(doc(db, "Business_owners", docId), {
      ownerName, businessName: business, email, phone, state, city, address, hours,
      businessType, services, notes, plan, createdAt: serverTimestamp()
    }, { merge: true });

    sessionStorage.setItem('bss_doc', docId);
    return { docId, plan };
  };
</script>

<!-- Embedded State -> City data (no external file needed) -->
<script>
  (function () {
    const DATA = {
      "AL": ["Birmingham","Huntsville","Mobile","Montgomery","Tuscaloosa","Hoover","Dothan","Auburn","Decatur","Madison","Florence","Gadsden","Phenix City","Prattville","Vestavia Hills"],
      "AK": ["Anchorage","Fairbanks","Juneau","Sitka","Ketchikan","Wasilla","Kenai","Palmer","Kodiak","Bethel","Valdez","Nome"],
      "AZ": ["Phoenix","Tucson","Mesa","Chandler","Gilbert","Scottsdale","Glendale","Tempe","Peoria","Surprise","Goodyear","Flagstaff","Yuma","Avondale","Casa Grande","Lake Havasu City","Sierra Vista"],
      "AR": ["Little Rock","Fort Smith","Fayetteville","Springdale","Jonesboro","North Little Rock","Conway","Rogers","Pine Bluff","Bentonville","Hot Springs","Benton","Sherwood","Texarkana"],
      "CA": ["Los Angeles","San Diego","San Jose","San Francisco","Fresno","Sacramento","Long Beach","Oakland","Bakersfield","Anaheim","Santa Ana","Riverside","Stockton","Irvine","Chula Vista","Fremont","Oxnard","Fontana","Moreno Valley","Garden Grove","Oceanside","Santa Clarita","Glendale","Hayward","Pomona","Escondido","Sunnyvale","Torrance","Pasadena","Thousand Oaks","Simi Valley","Roseville","Concord","Victorville"],
      "CO": ["Denver","Colorado Springs","Aurora","Fort Collins","Lakewood","Thornton","Arvada","Westminster","Pueblo","Greeley","Boulder","Longmont","Loveland","Broomfield"],
      "CT": ["Bridgeport","New Haven","Hartford","Stamford","Waterbury","Norwalk","Danbury","New Britain","West Hartford","Meriden"],
      "DE": ["Wilmington","Dover","Newark","Middletown","Smyrna","Seaford"],
      "FL": ["Jacksonville","Miami","Tampa","Orlando","St. Petersburg","Hialeah","Tallahassee","Fort Lauderdale","Port St. Lucie","Cape Coral","Pembroke Pines","Hollywood","Miramar","Gainesville","Coral Springs","Miami Gardens","Clearwater","Palm Bay","West Palm Beach","Lakeland","Pompano Beach","Davie","Miami Beach","Riverview","Boynton Beach","Plantation","North Port","Sunrise","Deltona"],
      "GA": ["Atlanta","Augusta","Columbus","Macon","Savannah","Athens","Sandy Springs","Roswell","Albany","Johns Creek","Warner Robins","Valdosta","Alpharetta","Marietta","Smyrna","Gainesville","Dunwoody"],
      "HI": ["Honolulu","Hilo","Kailua","Kapolei","Kaneohe","Pearl City","Waipahu","Kahului"],
      "ID": ["Boise","Meridian","Nampa","Idaho Falls","Pocatello","Caldwell","Coeur d'Alene","Twin Falls","Lewiston"],
      "IL": ["Chicago","Aurora","Naperville","Joliet","Rockford","Springfield","Peoria","Elgin","Waukegan","Cicero","Champaign","Bloomington","Arlington Heights","Evanston","Decatur","Schaumburg","Bolingbrook","Palatine","Skokie"],
      "IN": ["Indianapolis","Fort Wayne","Evansville","South Bend","Carmel","Bloomington","Hammond","Gary","Lafayette","Muncie","Terre Haute","Fishers","Greenwood"],
      "IA": ["Des Moines","Cedar Rapids","Davenport","Sioux City","Iowa City","Council Bluffs","Ames","West Des Moines","Waterloo","Dubuque"],
      "KS": ["Wichita","Overland Park","Kansas City","Olathe","Topeka","Lawrence","Shawnee","Manhattan","Lenexa","Salina"],
      "KY": ["Louisville","Lexington","Bowling Green","Owensboro","Covington","Richmond","Florence","Hopkinsville","Henderson","Frankfort"],
      "LA": ["New Orleans","Baton Rouge","Shreveport","Lafayette","Lake Charles","Kenner","Bossier City","Monroe","Alexandria","Houma","Slidell","Mandeville"],
      "ME": ["Portland","Lewiston","Bangor","South Portland","Auburn","Augusta","Westbrook","Waterville"],
      "MD": ["Baltimore","Frederick","Rockville","Gaithersburg","Bowie","Hagerstown","Annapolis","College Park","Salisbury","Laurel"],
      "MA": ["Boston","Worcester","Springfield","Cambridge","Lowell","Brockton","New Bedford","Quincy","Lynn","Newton","Fall River","Somerville","Waltham","Malden","Brookline"],
      "MI": ["Detroit","Grand Rapids","Warren","Sterling Heights","Ann Arbor","Lansing","Flint","Dearborn","Livonia","Troy","Westland","Farmington Hills","Kalamazoo","Wyoming","Rochester Hills"],
      "MN": ["Minneapolis","Saint Paul","Rochester","Duluth","Bloomington","Brooklyn Park","Plymouth","Saint Cloud","Eagan","Maple Grove"],
      "MS": ["Jackson","Gulfport","Southaven","Hattiesburg","Biloxi","Meridian","Natchez","Olive Branch"],
      "MO": ["Kansas City","St. Louis","Springfield","Independence","Columbia","Lee's Summit","O'Fallon","St. Joseph","Chesterfield","St. Charles"],
      "MT": ["Billings","Missoula","Great Falls","Bozeman","Butte","Helena"],
      "NE": ["Omaha","Lincoln","Bellevue","Grand Island","Kearney","Fremont","Hastings"],
      "NV": ["Las Vegas","Henderson","Reno","North Las Vegas","Sparks","Carson City","Pahrump","Elko"],
      "NH": ["Manchester","Nashua","Concord","Derry","Rochester"],
      "NJ": ["Newark","Jersey City","Paterson","Elizabeth","Edison","Woodbridge","Toms River","Clifton","Camden","Trenton","Cherry Hill"],
      "NM": ["Albuquerque","Las Cruces","Rio Rancho","Santa Fe","Roswell","Farmington","Clovis","Hobbs"],
      "NY": ["New York City","Buffalo","Rochester","Yonkers","Syracuse","Albany","New Rochelle","Mount Vernon","Schenectady","Utica","White Plains","Troy","Niagara Falls","Binghamton"],
      "NC": ["Charlotte","Raleigh","Greensboro","Durham","Winston-Salem","Fayetteville","Cary","Wilmington","High Point","Asheville","Concord","Gastonia","Jacksonville"],
      "ND": ["Fargo","Bismarck","Grand Forks","Minot","West Fargo"],
      "OH": ["Columbus","Cleveland","Cincinnati","Toledo","Akron","Dayton","Parma","Canton","Youngstown","Lorain","Hamilton","Springfield","Kettering"],
      "OK": ["Oklahoma City","Tulsa","Norman","Broken Arrow","Lawton","Edmond","Moore","Midwest City","Enid","Stillwater"],
      "OR": ["Portland","Eugene","Salem","Gresham","Hillsboro","Beaverton","Bend","Medford","Springfield","Corvallis"],
      "PA": ["Philadelphia","Pittsburgh","Allentown","Erie","Reading","Scranton","Bethlehem","Lancaster","Harrisburg","York","Altoona","State College"],
      "RI": ["Providence","Warwick","Cranston","Pawtucket","East Providence","Woonsocket"],
      "SC": ["Columbia","Charleston","North Charleston","Mount Pleasant","Rock Hill","Greenville","Summerville","Sumter"],
      "SD": ["Sioux Falls","Rapid City","Aberdeen","Brookings","Watertown"],
      "TN": ["Memphis","Nashville","Knoxville","Chattanooga","Clarksville","Murfreesboro","Franklin","Jackson","Johnson City"],
      "TX": ["Houston","San Antonio","Dallas","Austin","Fort Worth","El Paso","Arlington","Corpus Christi","Plano","Laredo","Lubbock","Garland","Irving","Amarillo","Grand Prairie","McKinney","Frisco","Brownsville","Pasadena","Killeen","Waco","Midland","Abilene","Carrollton","Round Rock"],
      "UT": ["Salt Lake City","West Valley City","Provo","West Jordan","Orem","Sandy","Ogden","St. George"],
      "VT": ["Burlington","South Burlington","Rutland","Barre","Montpelier"],
      "VA": ["Virginia Beach","Norfolk","Chesapeake","Richmond","Newport News","Alexandria","Hampton","Roanoke","Portsmouth","Suffolk","Leesburg"],
      "WA": ["Seattle","Spokane","Tacoma","Vancouver","Bellevue","Kent","Everett","Renton","Yakima","Bellingham","Olympia","Federal Way"],
      "WV": ["Charleston","Huntington","Morgantown","Parkersburg","Wheeling","Weirton"],
      "WI": ["Milwaukee","Madison","Green Bay","Kenosha","Racine","Appleton","Waukesha","Eau Claire","Oshkosh","Janesville"],
      "WY": ["Cheyenne","Casper","Laramie","Gillette","Rock Springs","Sheridan"]
    };
    // Expose globally (and under both names for compatibility)
    window.citiesByState = DATA;
    window.CITIES_BY_STATE = DATA;
  })();
</script>

<!-- Binder: populate State -> City -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const stateEl = document.getElementById('stateSelect');
    const cityEl  = document.getElementById('citySelect');
    const hiddenState = document.getElementById('stateHidden');
    const hiddenCity  = document.getElementById('cityHidden');

    const DATA = window.citiesByState || window.CITIES_BY_STATE;
    if (!stateEl || !cityEl || !DATA) return;

    const CODE_TO_NAME = {
      AL:"Alabama",AK:"Alaska",AZ:"Arizona",AR:"Arkansas",CA:"California",CO:"Colorado",CT:"Connecticut",DE:"Delaware",
      FL:"Florida",GA:"Georgia",HI:"Hawaii",ID:"Idaho",IL:"Illinois",IN:"Indiana",IA:"Iowa",KS:"Kansas",KY:"Kentucky",
      LA:"Louisiana",ME:"Maine",MD:"Maryland",MA:"Massachusetts",MI:"Michigan",MN:"Minnesota",MS:"Mississippi",MO:"Missouri",
      MT:"Montana",NE:"Nebraska",NV:"Nevada",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NY:"New York",
      NC:"North Carolina",ND:"North Dakota",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",RI:"Rhode Island",
      SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VT:"Vermont",VA:"Virginia",
      WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"
    };

    function resetCities(){
      cityEl.innerHTML = '<option value="" disabled selected>Select City</option>';
      cityEl.disabled = true;
      hiddenCity.value = '';
    }

    // Populate state list
    const codes = Object.keys(DATA).filter(k => k.length === 2);
    stateEl.innerHTML =
      '<option value="" disabled selected>Select State</option>' +
      codes.map(code => `<option value="${code}">${CODE_TO_NAME[code]||code}</option>`).join('');

    resetCities();

    stateEl.addEventListener('change', function () {
      const code = stateEl.value;
      const cities = DATA[code] || [];
      resetCities();
      if (!cities.length) { hiddenState.value = code; return; }

      const frag = document.createDocumentFragment();
      cities.forEach(c=>{
        const opt = document.createElement('option');
        opt.value = c;
        opt.textContent = c;
        frag.appendChild(opt);
      });
      cityEl.appendChild(frag);
      cityEl.disabled = false;
      hiddenState.value = code;
    });

    cityEl.addEventListener('change', function () {
      hiddenCity.value = cityEl.value;
    });
  });
</script>

<!-- PayPal (loads after save) -->
<script>
  const PAYPAL_CLIENT_ID = "EPnN8sfzHMua72kW2vyRp2nLph-ManxYnzSkHflGbkFlhqkSef8KMNuOG-3WxLKxpWbWBwPFnGRLskxB";
  const MONTHLY_PLAN_ID  = "37739232P6875371KNB7M33A";   // $29.95 + $4.95
  const ANNUAL_PLAN_ID   = "P-6VE96793E07454030NB7M7IA";  // $287.52 + $4.95

  const form = document.getElementById('signupForm');
  const submitBtn = document.getElementById('submitBtn');

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    submitBtn.disabled=true; submitBtn.textContent="Saving…";
    try{
      const { plan } = await window.BSS.save();
      const planId = (plan==='annual') ? ANNUAL_PLAN_ID : MONTHLY_PLAN_ID;

      const s=document.createElement('script');
      s.src = `https://www.paypal.com/sdk/js?client-id=${encodeURIComponent(PAYPAL_CLIENT_ID)}&vault=true&intent=subscription`;
      document.body.appendChild(s);

      s.onload = ()=>{
        const hidden=document.createElement('div');
        hidden.id='pp-hidden'; hidden.style.position='fixed'; hidden.style.left='-9999px'; hidden.style.top='-9999px';
        document.body.appendChild(hidden);
        // @ts-ignore
        paypal.Buttons({
          style:{layout:'vertical',label:'subscribe'},
          createSubscription:(data,actions)=>actions.subscription.create({plan_id:planId}),
          onApprove:()=>{ const id=sessionStorage.getItem('bss_doc')||''; window.location.href = "success.html?business="+encodeURIComponent(id); },
          onError:(err)=>{ console.error(err); alert("PayPal error. Please try again."); submitBtn.disabled=false; submitBtn.textContent="Continue to Payment"; }
        }).render('#pp-hidden');
      };

      s.onerror = ()=>{
        window.location.href = "https://www.paypal.com/webapps/billing/subscriptions?plan_id="+encodeURIComponent(planId);
      };

    }catch(err){
      console.error(err);
      alert(err.message || "Please complete all required fields.");
      submitBtn.disabled=false; submitBtn.textContent="Continue to Payment";
    }
  });
</script>

</body>
</html>
